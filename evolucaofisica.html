<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ares RPG - Evolu√ß√£o F√≠sica</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #3b82f6; --danger: #ef4444; --success: #22c55e; --bg: #0f172a; }
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: #f8fafc; padding: 15px; margin: 0; }
        .card { background: rgba(30, 41, 59, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(51, 65, 85, 0.5); margin-bottom: 15px; }
        .grid-exercicios { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .stat-box { background: rgba(51, 65, 85, 0.6); padding: 10px; border-radius: 10px; text-align: center; border: 1px solid #475569; }
        input { width: 100%; padding: 10px; margin: 5px 0; border-radius: 8px; border: none; box-sizing: border-box; background: #1e293b; color: white; text-align: center; }
        button { cursor: pointer; padding: 10px; border: none; border-radius: 8px; color: white; font-weight: bold; width: 100%; background: var(--danger); }
        .btn-back { background: var(--primary); text-decoration: none; display: block; text-align: center; padding: 12px; border-radius: 8px; color: white; margin-bottom: 15px; font-weight: bold; }
    </style>
</head>
<body>
    <a href="index.html" class="btn-back">‚¨Ö VOLTAR AO PAINEL</a>

    <div class="card">
        <h3 style="text-align:center; color: var(--danger);">üèãÔ∏è MINHA EVOLU√á√ÉO</h3>
        <p id="player-name" style="text-align:center; color: #94a3b8; font-size: 14px;">Carregando atleta...</p>
        
        <div class="grid-exercicios" id="lista-treino">
            </div>
    </div>

    <script>
        // Use a sua firebaseConfig id√™ntica ao index.html
        const firebaseConfig = {
            apiKey: "AIzaSy...", 
            authDomain: "aresrpg-...",
            databaseURL: "https://aresrpg-...",
            projectId: "aresrpg-...",
            storageBucket: "aresrpg-...",
            messagingSenderId: "...",
            appId: "..."
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();

        // Lista de Exerc√≠cios Completa
        const exercicios = [
            { id: 'supino', nome: 'Supino Reto' },
            { id: 'agachamento', nome: 'Agachamento' },
            { id: 'terra', nome: 'Lev. Terra' },
            { id: 'rosca', nome: 'Rosca Direta' },
            { id: 'triceps', nome: 'Tr√≠ceps Pulley' },
            { id: 'legpress', nome: 'Leg Press' },
            { id: 'desenvolvimento', nome: 'Ombros' },
            { id: 'puxada', nome: 'Puxada Costas' }
        ];

        auth.onAuthStateChanged(user => {
            if (user) {
                const jogadorId = user.email.split('@')[0].replace(/[.#$[\]]/g, "_");
                document.getElementById('player-name').innerText = "Atleta: " + jogadorId;
                
                db.ref('rpg_data/' + jogadorId).on('value', snapshot => {
                    const data = snapshot.val() || {};
                    renderizar(data, jogadorId);
                });
            } else {
                window.location.href = "index.html";
            }
        });

        function renderizar(data, jogadorId) {
            const container = document.getElementById('lista-treino');
            const records = data.recordsFisico || {};
            
            container.innerHTML = exercicios.map(ex => `
                <div class="stat-box">
                    <span style="font-size: 12px; display:block; margin-bottom:5px;">${ex.nome}</span>
                    <input type="number" id="input-${ex.id}" placeholder="${records[ex.id] || 0}kg">
                    <button onclick="salvarTreino('${ex.id}', '${jogadorId}')">SALVAR</button>
                </div>
            `).join('');
        }

        async function salvarTreino(id, jogadorId) {
            const peso = document.getElementById('input-' + id).value;
            if(!peso || peso <= 0) return alert("Insira um peso!");

            const ref = db.ref('rpg_data/' + jogadorId);
            const snap = await ref.get();
            const player = snap.val() || {};

            // Atualiza XP e o recorde do exerc√≠cio espec√≠fico
            await ref.update({
                xp: (player.xp || 0) + 1,
                [`recordsFisico/${id}`]: peso
            });

            alert("Evolu√ß√£o salva! +1 XP");
        }
    </script>
</body>
</html>
