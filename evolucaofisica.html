<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ares RPG - EvoluÃ§Ã£o FÃ­sica</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #3b82f6; --danger: #ef4444; --success: #22c55e; --bg: #0f172a; }
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: #f8fafc; padding: 15px; }
        .card { background: rgba(30, 41, 59, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(51, 65, 85, 0.5); margin-bottom: 15px; }
        .stat-box { background: rgba(51, 65, 85, 0.6); padding: 10px; border-radius: 10px; text-align: center; border: 1px solid #475569; }
        input { width: 100%; padding: 10px; margin: 5px 0; border-radius: 8px; border: none; box-sizing: border-box; }
        button { cursor: pointer; padding: 10px; border: none; border-radius: 8px; color: white; font-weight: bold; width: 100%; background: var(--danger); margin-top: 5px; }
        .btn-back { background: var(--primary); margin-bottom: 20px; text-decoration: none; display: block; text-align: center; padding: 10px; border-radius: 8px; color: white; }
    </style>
</head>
<body>
    <a href="/" class="btn-back">â¬… Voltar ao RPG</a>

    <div class="card">
        <h3>ðŸ”¥ Sala de Treinamento (Limite +10 XP/dia)</h3>
        <p id="status-xp" style="font-size: 14px; color: #94a3b8;">Carregando progresso...</p>
        <div id="grid-fisico" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top: 15px;">
            </div>
    </div>

    <script>
        // Use a sua configuraÃ§Ã£o EXATA que estÃ¡ no index.html
        const firebaseConfig = {
            apiKey: "AIzaSy...", 
            authDomain: "aresrpg-...",
            databaseURL: "https://aresrpg-...",
            projectId: "aresrpg-...",
            storageBucket: "aresrpg-...",
            messagingSenderId: "...",
            appId: "..."
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();
        let jogadorAtual = "";

        const exercicios = [
            { id: 'supino', nome: 'Supino', icon: 'ðŸ‹ï¸' },
            { id: 'agachamento', nome: 'Agachamento', icon: 'ðŸ¦µ' },
            { id: 'rosca', nome: 'Rosca Direta', icon: 'ðŸ’ª' },
            { id: 'legpress', nome: 'Leg Press', icon: 'ðŸ¦¶' },
            { id: 'puxada', nome: 'Puxada Costas', icon: 'ðŸ¦…' },
            { id: 'desenvolvimento', nome: 'Ombros', icon: 'ðŸ†™' }
        ];

        auth.onAuthStateChanged(user => {
            if (user) {
                jogadorAtual = user.email.split('@')[0].replace(/[.#$[\]]/g, "_");
                db.ref('rpg_data/' + jogadorAtual).on('value', snapshot => {
                    const data = snapshot.val() || {};
                    renderizarExercicios(data);
                });
            } else {
                window.location.href = "/";
            }
        });

        function renderizarExercicios(data) {
            const grid = document.getElementById('grid-fisico');
            const records = data.recordsFisico || {};
            grid.innerHTML = exercicios.map(ex => `
                <div class="stat-box">
                    <span>${ex.icon} ${ex.nome}</span>
                    <input type="number" id="input-${ex.id}" placeholder="${records[ex.id] || 0}kg">
                    <button onclick="upFisico('${ex.id}')">ATUALIZAR</button>
                </div>
            `).join('');
            document.getElementById('status-xp').innerText = `Seu XP Atual: ${data.xp || 0}`;
        }

        async function upFisico(id) {
            const novaCarga = document.getElementById(`input-${id}`).value;
            if(!novaCarga || novaCarga <= 0) return alert("Digite uma carga vÃ¡lida!");

            const ref = db.ref('rpg_data/' + jogadorAtual);
            const snapshot = await ref.get();
            const p = snapshot.val();

            // LÃ³gica de XP (Limite de 10 por dia pode ser adicionado aqui)
            const atualizacao = {
                xp: (p.xp || 0) + 1,
                [`recordsFisico/${id}`]: novaCarga
            };

            await ref.update(atualizacao);
            alert("Treino registrado! +1 XP");
        }
    </script>
</body>
</html>
